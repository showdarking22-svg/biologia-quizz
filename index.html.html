<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulazione Esame Biologia - Infermieristica</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --success: #27ae60;
            --error: #c0392b;
            --light: #ecf0f1;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 800px;
            padding: 30px;
            overflow: hidden;
        }

        h1 {
            color: var(--primary);
            text-align: center;
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
        }

        /* Schermata Start */
        #start-screen {
            text-align: center;
        }

        button {
            background-color: var(--accent);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
            margin-top: 20px;
        }

        button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        /* Schermata Quiz */
        #quiz-screen {
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: #eee;
            border-radius: 5px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--accent);
            width: 0%;
            transition: width 0.3s ease;
        }

        .question-box {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 25px;
            color: var(--primary);
        }

        .options-grid {
            display: grid;
            gap: 15px;
        }

        .option-btn {
            background-color: white;
            border: 2px solid #e0e0e0;
            color: #333;
            text-align: left;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1rem;
        }

        .option-btn:hover {
            border-color: var(--accent);
            background-color: #f9fcff;
        }

        .option-btn.selected {
            background-color: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        /* Schermata Risultati */
        #result-screen {
            display: none;
            text-align: center;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            background: var(--accent);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 2.5rem;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .status-pass {
            background-color: var(--success);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
        }

        .status-fail {
            background-color: var(--error);
            box-shadow: 0 5px 15px rgba(192, 57, 43, 0.4);
        }

        .review-section {
            text-align: left;
            margin-top: 30px;
            max-height: 400px;
            overflow-y: auto;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }

        .review-item {
            margin-bottom: 15px;
            padding: 15px;
            border-radius: 8px;
            background-color: #f8f9fa;
            border-left: 5px solid #ccc;
        }

        .review-item.correct {
            border-left-color: var(--success);
        }

        .review-item.wrong {
            border-left-color: var(--error);
        }

        .review-q {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .review-ans {
            font-size: 0.9rem;
        }

        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            color: white;
            font-size: 0.8rem;
            margin-right: 5px;
        }

        .badge-correct { background-color: var(--success); }
        .badge-wrong { background-color: var(--error); }
        .badge-info { background-color: var(--accent); }

    </style>
</head>
<body>

<div class="container">
    <div id="start-screen">
        <h1>Esame di Biologia</h1>
        <div class="subtitle">Simulazione Ufficiale Infermieristica</div>
        <p>58 Domande tratte dal database dell'esame.</p>
        <p>Il punteggio sarà calcolato in <strong>30esimi</strong>.</p>
        <p><em>Sufficienza: 18/30</em></p>
        <button onclick="startQuiz()">Inizia l'Esame</button>
    </div>

    <div id="quiz-screen">
        <div class="progress-bar">
            <div class="progress-fill" id="progress"></div>
        </div>
        <div style="display: flex; justify-content: space-between; color: #7f8c8d; margin-bottom: 10px;">
            <span id="question-count">Domanda 1/58</span>
        </div>
        <div class="question-box" id="question-text">
            Caricamento domanda...
        </div>
        <div class="options-grid" id="options-container">
            </div>
    </div>

    <div id="result-screen">
        <h2>Esito Esame</h2>
        <div class="score-circle" id="final-score">--</div>
        <h3 id="score-message"></h3>
        <p id="stats-text"></p>
        
        <button onclick="location.reload()">Riprova Esame</button>

        <div class="review-section" id="review-container">
            <h3>Revisione Risposte</h3>
            </div>
    </div>
</div>

<script>
    // DATABASE DOMANDE
    // Ho inserito distrattori logici per rendere difficile il quiz come richiesto.
    const questionsDb = [
        { q: "Le cellule eucariotiche:", a: "Contengono organelli che hanno funzioni specifiche", d: ["Non hanno nucleo definito", "Sono sempre unicellulari", "Non possiedono ribosomi"], exp: "Gli eucarioti si distinguono per la compartimentazione interna (organelli)." },
        { q: "Quanti diversi amminoacidi (aa) si trovano negli esseri viventi?", a: "20", d: ["4", "64", "12"], exp: "Esistono 20 amminoacidi standard codificati dal codice genetico." },
        { q: "I batteri sono:", a: "Procarioti", d: ["Eucarioti", "Virus", "Funghi"], exp: "I batteri sono organismi unicellulari privi di nucleo (procarioti)." },
        { q: "I procarioti non hanno ribosomi.", a: "Falso", d: ["Vero"], exp: "I procarioti HANNO ribosomi (70S) per la sintesi proteica." },
        { q: "Sia procarioti che eucarioti sono in grado di compiere glicolisi.", a: "Vero", d: ["Falso"], exp: "La glicolisi è un processo metabolico ancestrale comune a quasi tutti gli esseri viventi." },
        { q: "La membrana plasmatica degli eucarioti è sostanzialmente simile a quella dei procarioti.", a: "Vero", d: ["Falso"], exp: "Entrambe sono costituite da un doppio strato fosfolipidico con proteine." },
        { q: "Quali dei seguenti organelli citoplasmatici della cellula eucariote contiene DNA?", a: "Mitocondri", d: ["Apparato di Golgi", "Lisosomi", "Reticolo Endoplasmatico"], exp: "I mitocondri hanno un proprio DNA circolare." },
        { q: "Cos’è un procariote?", a: "Una cellula senza compartimenti citoplasmatici", d: ["Una cellula con nucleo ben definito", "Un virus", "Una cellula vegetale"], exp: "Mancano di nucleo e organelli membranosi." },
        { q: "I ribosomi sono strutture cellulari la cui funzione è:", a: "Sintesi proteine", d: ["Sintesi lipidi", "Produzione di ATP", "Digestione cellulare"], exp: "Sono le 'fabbriche' che assemblano gli amminoacidi." },
        { q: "Due cromosomi si dicono omologhi quando:", a: "Uno padre uno madre, stessi geni e fanno crossing over", d: ["Sono identici al 100%", "Provengono dallo stesso genitore", "Non portano gli stessi geni"], exp: "Hanno la stessa morfologia e portano gli stessi caratteri (loci), ma possono avere alleli diversi." },
        { q: "Quale struttura c’è negli eucarioti ma non nei procarioti?", a: "Mitocondri", d: ["Ribosomi", "Membrana plasmatica", "DNA"], exp: "Gli organelli membranosi come i mitocondri sono esclusivi degli eucarioti." },
        { q: "Nelle cellule eucariotiche le info genetiche sono contenute soltanto nel DNA.", a: "Vero", d: ["Falso"], exp: "Il DNA è il deposito dell'informazione genetica." },
        { q: "In una cellula eucariotica troviamo DNA in quale struttura oltre al nucleo?", a: "Mitocondri", d: ["Ribosomi", "Membrana", "Reticolo liscio"], exp: "I mitocondri (e i cloroplasti nelle piante) contengono DNA." },
        { q: "In quale biosintesi sono coinvolti i ribosomi?", a: "Proteine", d: ["Carboidrati", "Lipidi", "DNA"], exp: "È il processo di traduzione dell'mRNA." },
        { q: "La membrana cellulare è composta principalmente da:", a: "Fosfolipidi e proteine", d: ["Solo lipidi", "Cellulosa", "Proteine e acidi nucleici"], exp: "Il modello è il 'mosaico fluido'." },
        { q: "Una cellula diploide possiede:", a: "Una coppia di ciascun cromosoma", d: ["Una sola copia di ciascun cromosoma", "Tre copie di ciascun cromosoma", "Solo cromosomi sessuali"], exp: "2n: ha due set completi di cromosomi." },
        { q: "I cromatidi sono:", a: "Due formazioni che provengono dalla duplicazione di un cromosoma", d: ["Due cromosomi omologhi", "Pezzi di DNA virale", "Organelli cellulari"], exp: "Sono le due copie identiche (fratelli) unite dal centromero dopo la fase S." },
        { q: "Il concetto che i cromosomi omologhi si separano nella formazione dei gameti è espresso:", a: "Nella legge di segregazione dei caratteri", d: ["Nella legge dell'assortimento indipendente", "Nella legge della dominanza", "Nel linkage"], exp: "Prima legge di Mendel: i due alleli si separano." },
        { q: "Si definiscono alleli:", a: "Geni che occupano lo stesso locus in cromosomi omologhi", d: ["Geni su cromosomi diversi", "Geni con funzioni opposte", "Proteine del nucleo"], exp: "Sono le forme alternative di uno stesso gene." },
        { q: "Un cromosoma duplicato ha:", a: "Due cromatidi", d: ["Due centromeri", "Un solo cromatidio", "Quattro bracci lunghi"], exp: "Dopo la duplicazione, è composto da due cromatidi fratelli." },
        { q: "Il crossing-over:", a: "Provoca ricombinazione genetica", d: ["Avviene durante la mitosi", "Crea cloni identici", "Riduce la variabilità"], exp: "Scambio di segmenti tra omologhi in Profase I della Meiosi." },
        { q: "Il crossing over produce ricombinazione genica.", a: "Vero", d: ["Falso"], exp: "Mescola gli alleli materni e paterni." },
        { q: "Rispetto alla riproduzione asessuale, la riproduzione sessuale produce:", a: "4 cellule figlie (nella meiosi)", d: ["2 cellule identiche", "Cloni", "Cellule diploidi"], exp: "La meiosi porta a 4 cellule aploidi diverse." },
        { q: "I gameti:", a: "Sono cellule della linea germinale con corredo cromosomico aploide", d: ["Sono cellule somatiche diploidi", "Hanno 46 cromosomi", "Si dividono per mitosi"], exp: "Spermatozoi e ovuli sono n (23 cromosomi)." },
        { q: "L’ormone FSH e LH vengono prodotti solo dalla donna.", a: "Falso", d: ["Vero"], exp: "Sono prodotti anche nell'uomo (regolano spermatogenesi e testosterone)." },
        { q: "Il testosterone è prodotto dalle cellule di Leydig.", a: "Vero", d: ["Falso"], exp: "Le cellule di Leydig si trovano nei testicoli." },
        { q: "Uomo: gameti ... cromosomi, cellule somatiche ... cromosomi.", a: "23, 46", d: ["46, 23", "46, 46", "23, 23"], exp: "I gameti sono aploidi (n=23), le somatiche diploidi (2n=46)." },
        { q: "Quanti cromosomi nei gameti dello scimpanzè?", a: "24", d: ["23", "48", "46"], exp: "Lo scimpanzè ha 48 cromosomi nelle somatiche, quindi 24 nei gameti." },
        { q: "I tratti osservabili di un organismo costituiscono il suo:", a: "Fenotipo", d: ["Genotipo", "Cariotipo", "Genoma"], exp: "Il fenotipo è l'espressione visibile del genotipo." },
        { q: "AaBb x AaBb produce prole diversa dai genitori. Ciò illustra:", a: "Il principio dell’assortimento indipendente", d: ["La segregazione", "La dominanza incompleta", "L'epistasi"], exp: "I geni per caratteri diversi si distribuiscono indipendentemente." },
        { q: "Genitori gruppo sanguigno A e 0. I figli possono essere:", a: "0 o A", d: ["Solo A", "A, B o 0", "Solo 0"], exp: "Se A è eterozigote (A0) e l'altro è 00, i figli possono essere A0 o 00." },
        { q: "Nella specie umana il sesso della prole è determinato:", a: "Dal gamete maschile durante la fecondazione", d: ["Dal gamete femminile", "Dall'ambiente", "Dagli ormoni materni"], exp: "Lo spermatozoo può portare X o Y." },
        { q: "Quali diversi tipi di gameti possono essere prodotti da genotipo AaBb?", a: "AB, Ab, aB, ab", d: ["Aa, Bb", "A, B, a, b", "AB, ab"], exp: "4 combinazioni possibili (2^n)." },
        { q: "Incrocio AaBb x aabb produce rapporto genotipico 1:1:1:1.", a: "Vero", d: ["Falso"], exp: "È un test-cross di un diibrido." },
        { q: "Un individuo si dice omozigote per un certo carattere se possiede:", a: "2 alleli uguali", d: ["2 alleli diversi", "Un solo allele", "Nessun allele"], exp: "Es: AA o aa." },
        { q: "Genitori sani portatori di ritardo mentale autosomico recessivo. Probabilità prossimo figlio malato?", a: "25%", d: ["50%", "75%", "0%"], exp: "Aa x Aa -> 25% aa (malato)." },
        { q: "Padre daltonico e madre portatrice sana. Probabilità figli malati (maschi e femmine)?", a: "50% maschi e femmine", d: ["100% maschi, 0% femmine", "Solo maschi", "25% totale"], exp: "Padre XdY, Madre XDXd. Figli: XdY (malato), XDY (sano). Figlie: XdXd (malata), XDXd (portatrice)." },
        { q: "Incrocio AaBb x AaBb produce generazione con rapporto genotipico:", a: "9:3:3:1", d: ["1:1:1:1", "3:1", "1:2:1"], exp: "Classico rapporto fenotipico mendeliano per diibridi." },
        { q: "Alleli sono:", a: "Forme molecolari alternative di un gene", d: ["Geni diversi", "Cromosomi diversi", "Proteine istoniche"], exp: "Varianti dello stesso gene." },
        { q: "Porcellini d'India: Nero (B) dominante su bianco (b). Incrocio due neri, prole 3:1 neri/bianchi. Genitori?", a: "Bb, Bb", d: ["BB, bb", "BB, Bb", "bb, bb"], exp: "Il rapporto 3:1 indica un incrocio tra due eterozigoti." },
        { q: "Cos’è l’anticodone?", a: "Sequenza di 3 nucleotidi nel t-RNA", d: ["Sequenza nel DNA", "Sequenza nell'mRNA", "Parte del ribosoma"], exp: "Si appaia al codone dell'mRNA." },
        { q: "Scopritori struttura DNA (1953):", a: "James Watson e Francis Crick", d: ["Darwin e Wallace", "Mendel", "Franklin e Wilkins"], exp: "Nobel per la doppia elica." },
        { q: "Quanti aa sono codificati in: CGUUUACACCGUCAC?", a: "Cinque", d: ["Tre", "Quindici", "Quattro"], exp: "15 basi / 3 basi per codone = 5 amminoacidi." },
        { q: "La duplicazione del DNA è semi-conservativa.", a: "Vero", d: ["Falso"], exp: "Ogni nuova elica ha un filamento vecchio e uno nuovo." },
        { q: "Nel DNA del bue guanina=19%. %timina?", a: "31%", d: ["61%", "19%", "81%"], exp: "G=19 -> C=19. G+C=38. Rimane 62 per A+T. T = 31%. (Nota: 61% nel testo originale è errato matematicamente)." },
        { q: "Sequenza stampo DNA (3’)-TACATGTTCCAG-(5’). Complementare?", a: "(5’)-AUGUACAAGGUC-(3’)", d: "(5’)-UACAUGAAGGUC-(3’)", exp: "L'RNA ha U al posto di T e direzione antiparallela." },
        { q: "L’universalità del codice genetico indica che le triplette codificano per gli stessi aa in quasi tutti gli esseri viventi.", a: "Vero", d: ["Falso"], exp: "È una prova dell'origine comune della vita." },
        { q: "Resistenza antibiotica batteri dovuta a:", a: "Selezione naturale e plasmidi R", d: ["Mutazioni indotte dall'antibiotico", "Volontà del batterio", "Mitosi"], exp: "L'uso di antibiotici seleziona i ceppi resistenti." },
        { q: "Equilibrio di Hardy-Weinberg: frequenze alleliche non cambiano.", a: "Vero", d: ["Falso"], exp: "In assenza di forze evolutive." },
        { q: "Una struttura omologa:", a: "È posseduta da specie che hanno un medesimo progenitore comune", d: ["Ha la stessa funzione ma origine diversa", "È identica in tutto", "Non ha funzione"], exp: "Indica divergenza evolutiva." },
        { q: "L’australopiteco camminava ancora in maniera quadrupede:", a: "Falso (bipedismo)", d: ["Vero"], exp: "L'Australopiteco è noto per il bipedismo, anche se conservava tratti arboricoli. (Nota: Se il tuo testo dice Vero, è probabilmente un errore o si riferisce a tratti arcaici, ma la risposta scientifica è Falso)." },
        { q: "L’accoppiamento non casuale (scelta sessuale) è un agente di selezione.", a: "Vero", d: ["Falso"], exp: "Favorisce certi caratteri attraenti." },
        { q: "La selezione naturale agisce:", a: "Sull’intero fenotipo", d: ["Sul genotipo", "Solo sui geni recessivi", "Sull'ambiente"], exp: "L'ambiente seleziona l'individuo nel suo complesso." },
        { q: "L’aggressione competitiva intraspecifica rappresenta:", a: "Comportamento adattativo per risorse e partner", d: ["Un difetto genetico", "Un comportamento inutile", "Simbiosi"], exp: "Serve a stabilire gerarchie e accesso alla riproduzione." },
        { q: "Il dimorfismo sessuale è prodotto dalla:", a: "Selezione sessuale", d: ["Deriva genetica", "Mutazione casuale", "Migrazione"], exp: "Differenze fisiche tra maschi e femmine." },
        { q: "L'imprinting dimostra che il comportamento appreso:", a: "Dipende da meccanismi neurali innati", d: ["È completamente casuale", "Non esiste negli animali", "Dura pochi secondi"], exp: "È una forma di apprendimento geneticamente predisposta." },
        { q: "Definizione di selezione naturale:", a: "Sopravvivenza/riproduzione del più adatto all'ambiente", d: ["Sopravvivenza del più forte fisicamente", "Casuale eliminazione", "Evoluzione guidata"], exp: "Successo riproduttivo differenziale." }
    ];

    let currentQuestionIndex = 0;
    let score = 0;
    let userAnswers = [];

    // Shuffle Array Function
    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    // Prepare Quiz
    let quizSequence = [];

    function startQuiz() {
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('quiz-screen').style.display = 'block';
        // Shuffle questions
        quizSequence = shuffle([...questionsDb]); 
        showQuestion();
    }

    function showQuestion() {
        const qData = quizSequence[currentQuestionIndex];
        
        // Update UI Text
        document.getElementById('question-count').innerText = `Domanda ${currentQuestionIndex + 1} di ${questionsDb.length}`;
        document.getElementById('question-text').innerText = `${currentQuestionIndex + 1}. ${qData.q}`;
        
        // Progress Bar
        const progressPct = ((currentQuestionIndex) / questionsDb.length) * 100;
        document.getElementById('progress').style.width = `${progressPct}%`;

        // Generate Options
        const optionsContainer = document.getElementById('options-container');
        optionsContainer.innerHTML = '';

        let allOptions = [];
        // Handle logic for True/False options vs Multiple Choice
        if (qData.d.length === 1 && (qData.d[0] === "Vero" || qData.d[0] === "Falso")) {
            // It's likely True/False
            allOptions = [qData.a, qData.d[0]];
            // Don't shuffle True/False typically, or keep standard order if desired. 
            // Let's shuffle to be tricky.
            allOptions = shuffle(allOptions); 
        } else {
            // Multiple choice: Take correct + up to 3 distractors
            allOptions = [qData.a, ...qData.d];
            allOptions = shuffle(allOptions);
        }

        allOptions.forEach(optText => {
            const btn = document.createElement('div');
            btn.className = 'option-btn';
            if(Array.isArray(optText)) btn.innerText = optText[0]; // Fallback if array
            else btn.innerText = optText;
            
            btn.onclick = () => selectOption(btn, qData.a, optText);
            optionsContainer.appendChild(btn);
        });
    }

    function selectOption(btnElement, correctText, selectedText) {
        // Prevent multiple clicks
        const allBtns = document.querySelectorAll('.option-btn');
        allBtns.forEach(b => b.onclick = null);

        // Visual Feedback
        btnElement.classList.add('selected');

        // Record Answer
        const isCorrect = (selectedText === correctText);
        if (isCorrect) score++;

        userAnswers.push({
            question: quizSequence[currentQuestionIndex],
            selected: selectedText,
            isCorrect: isCorrect
        });

        // Delay for next question
        setTimeout(() => {
            currentQuestionIndex++;
            if (currentQuestionIndex < questionsDb.length) {
                showQuestion();
            } else {
                finishQuiz();
            }
        }, 800);
    }

    function finishQuiz() {
        document.getElementById('quiz-screen').style.display = 'none';
        document.getElementById('result-screen').style.display = 'block';

        // Calculate Score / 30
        const totalQ = questionsDb.length;
        const percentage = score / totalQ;
        const vote30 = Math.round(percentage * 30);

        const scoreCircle = document.getElementById('final-score');
        scoreCircle.innerText = vote30;
        
        const msg = document.getElementById('score-message');
        if (vote30 >= 18) {
            scoreCircle.classList.add('status-pass');
            msg.innerText = "ESAME SUPERATO!";
            msg.style.color = "var(--success)";
        } else {
            scoreCircle.classList.add('status-fail');
            msg.innerText = "NON SUPERATO";
            msg.style.color = "var(--error)";
        }

        document.getElementById('stats-text').innerText = 
            `Hai risposto correttamente a ${score} domande su ${totalQ}.`;

        // Generate Review
        const reviewCont = document.getElementById('review-container');
        userAnswers.forEach((item, idx) => {
            const div = document.createElement('div');
            div.className = `review-item ${item.isCorrect ? 'correct' : 'wrong'}`;
            
            div.innerHTML = `
                <div class="review-q">${idx + 1}. ${item.question.q}</div>
                <div class="review-ans">
                    <span class="badge ${item.isCorrect ? 'badge-correct' : 'badge-wrong'}">
                        ${item.isCorrect ? 'Corretto' : 'Errato'}
                    </span>
                    ${!item.isCorrect ? `La tua risposta: <s>${item.selected}</s><br>` : ''}
                    <strong>Risposta giusta:</strong> ${item.question.a}
                    <br><br>
                    <small><em><span class="badge badge-info">Info</span> ${item.question.exp}</em></small>
                </div>
            `;
            reviewCont.appendChild(div);
        });
    }

</script>

</body>
</html>